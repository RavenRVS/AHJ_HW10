(()=>{"use strict";(new class{constructor(){this.container=document.getElementById("widget"),this.addTicket=this.addTicket.bind(this),this.elem=null}createWidget(){const e=document.createElement("div");e.classList.add("widget-container"),e.innerHTML='\n      <div class="list"></div>\n      <div class="footer">\n        <form class="form">\n          <input class="form-input" name="input" type="text" placeholder="Введите текст и нажмите Enter">\n        </form>\n      </div>\n              ',this.container.appendChild(e),document.querySelector(".form").addEventListener("submit",this.addTicket)}addTicket(e){e.preventDefault(),this.elem=document.createElement("span"),this.elem.textContent=e.target.input.value,this.getPosition()}getPosition(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:n}=e.coords;this.showTicket(t.toFixed(5),n.toFixed(5))}),(e=>{this.showModal(),console.error(e)}))}resetInput(){this.container.querySelector(".form-input").value=""}showTicket(e,t){const n=document.querySelector(".list"),i=document.createElement("div");i.classList.add("ticket"),i.innerHTML=`\n         <div class="elem"></div>\n         <div class="date">${(new Date).toLocaleString()}</div>\n         <div class="geo">[${e},${t}]</div>\n      `,n.insertAdjacentElement("afterbegin",i),this.container.querySelector(".elem").insertAdjacentElement("afterbegin",this.elem),this.resetInput()}showModal(){const e=document.createElement("div");e.classList.add("modal"),e.innerHTML='\n        <div class="modal-text">Что-то пошло не так  \n        <p>Извините, но мы не можем определить ваше местоположение, \n        пожалуйста, дайте нам разрешение на использование геолокации \n        либо введите координаты вручную\n        </p>\n        <p>Широта и долгота через запятую</p>\n        <form class="modal-form">\n          <input class="modal-input" name="modal" type="text" placeholder="Введите текст и нажмите Enter">\n          <div class="buttons">\n          <button type="reset" class="reset">Отмена</button>\n          <button type="submit" class="ok">Ok</button>\n          </div>\n        </form>\n        </div>\n      ',this.container.querySelector(".widget-container").appendChild(e),this.container.querySelector(".modal-input").addEventListener("input",this.deleteError),this.container.querySelector(".modal-form").addEventListener("submit",(e=>{e.preventDefault();let t=this.checkValidity(e.target.modal.value);if(console.log(t),t){t=t[0].split(",");const e=t[0].trim(),n=t[1].trim();this.hideModal(),this.showTicket(e,n)}else alert("Координаты введены не верно")})),this.container.querySelector(".modal-form").addEventListener("reset",(e=>{e.preventDefault(),this.hideModal()}))}hideModal(){this.container.querySelector(".modal").remove(),this.resetInput()}checkValidity(e){return e.match(/^\[?\d+\.\d+,\s?\-?\d+\.\d+\]?$/gm)}}).createWidget()})();